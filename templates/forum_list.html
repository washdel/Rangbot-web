{% extends 'base.html' %}
{% load static %}

{% block title %}Forum RangBot - Diskusi & Berbagi Pengalaman{% endblock %}

{% block content %}
<div class="pt-28 pb-20 min-h-screen bg-gradient-to-b from-white via-gray-50/30 to-white relative overflow-hidden">
    <!-- Subtle Background Pattern -->
    <div class="absolute inset-0 opacity-[0.015]" style="background-image: radial-gradient(circle at 2px 2px, rgba(0,0,0,0.15) 1px, transparent 0); background-size: 40px 40px;"></div>
    
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <!-- Header -->
        <div class="text-center mb-12 sm:mb-16">
            <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full border mb-4" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(134, 239, 172, 0.1) 100%); border-color: rgba(239, 68, 68, 0.4);">
                <div class="w-2 h-2 rounded-full animate-pulse" style="background: linear-gradient(135deg, #ef4444 0%, #86efac 100%);"></div>
                <span class="text-xs sm:text-sm font-medium tracking-wide" style="background: linear-gradient(135deg, #ef4444 0%, #86efac 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Forum Komunitas</span>
            </div>
            <h1 class="text-3xl sm:text-4xl md:text-5xl text-gray-900 mb-4 sm:mb-6 tracking-tight font-light">
                <span class="bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 bg-clip-text text-transparent">Forum RangBot</span>
            </h1>
            <p class="text-base sm:text-lg md:text-xl text-gray-600 leading-relaxed font-light max-w-2xl mx-auto">
                Berbagi pengalaman, tips perawatan, dan diskusi tentang penyakit stroberi
            </p>
        </div>

        <!-- User Status & Actions -->
        <div class="mb-8 flex flex-col sm:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-4">
                {% if forum_user %}
                <div class="flex items-center gap-3 px-4 py-2 rounded-xl bg-white/80 backdrop-blur-sm border" style="border-color: rgba(134, 239, 172, 0.3);">
                    <div class="w-8 h-8 rounded-full flex items-center justify-center" style="background: linear-gradient(135deg, #86efac 0%, #4ade80 100%);">
                        <span class="text-white text-sm font-medium">{{ forum_user.name|first|upper }}</span>
                    </div>
                    <div>
                        <p class="text-sm font-medium text-gray-900">{{ forum_user.name }}</p>
                        <p class="text-xs text-gray-500">{{ forum_user.get_role_display }}</p>
                    </div>
                </div>
                <a href="{% url 'main:forum_logout' %}" class="px-4 py-2 rounded-xl text-sm font-light transition-all duration-300 hover:bg-gray-100" style="color: #6b7280;">
                    Logout
                </a>
                {% else %}
                <a href="{% url 'main:login' %}?next={% url 'main:forum_list' %}" class="px-6 py-3 rounded-xl text-white font-light text-sm sm:text-base transition-all duration-300 hover:scale-105" style="background: linear-gradient(135deg, #f87171 0%, #ef4444 100%); box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);">
                    Login untuk Posting
                </a>
                {% endif %}
            </div>
            {% if forum_user %}
            <a href="{% url 'main:forum_create' %}" class="px-6 py-3 rounded-xl text-white font-light text-sm sm:text-base transition-all duration-300 hover:scale-105" style="background: linear-gradient(135deg, #86efac 0%, #4ade80 100%); box-shadow: 0 4px 12px rgba(134, 239, 172, 0.3);">
                + Buat Postingan Baru
            </a>
            {% endif %}
        </div>

        <!-- Search & Filter -->
        <div class="mb-8 flex flex-col sm:flex-row gap-4">
            <form method="get" class="flex-1">
                <div class="relative">
                    <input type="text" name="search" value="{{ search_query }}" placeholder="Cari postingan..." 
                           class="w-full pl-12 pr-4 py-3 rounded-xl border transition-all duration-300 font-light text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-offset-0"
                           style="border-color: rgba(229, 231, 235, 0.6); background: rgba(255, 255, 255, 0.8);"
                           onfocus="this.style.borderColor='rgba(134, 239, 172, 0.5)'; this.style.boxShadow='0 0 0 3px rgba(134, 239, 172, 0.1)';"
                           onblur="this.style.borderColor='rgba(229, 231, 235, 0.6)'; this.style.boxShadow='none';">
                    <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                        <svg class="w-5 h-5" style="color: #9ca3af;" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                </div>
            </form>
            <div class="flex gap-2 flex-wrap">
                <a href="{% url 'main:forum_list' %}" class="px-4 py-2 rounded-xl text-sm font-light transition-all duration-300 {% if not current_category %}bg-white border-2{% else %}bg-white/50 border{% endif %}" 
                   style="{% if not current_category %}border-color: rgba(134, 239, 172, 0.4); color: #86efac;{% else %}border-color: rgba(229, 231, 235, 0.6); color: #6b7280;{% endif %}">
                    Semua
                </a>
                <a href="{% url 'main:forum_list' %}?category=penyakit" class="px-4 py-2 rounded-xl text-sm font-light transition-all duration-300 {% if current_category == 'penyakit' %}bg-white border-2{% else %}bg-white/50 border{% endif %}" 
                   style="{% if current_category == 'penyakit' %}border-color: rgba(239, 68, 68, 0.4); color: #ef4444;{% else %}border-color: rgba(229, 231, 235, 0.6); color: #6b7280;{% endif %}">
                    Penyakit
                </a>
                <a href="{% url 'main:forum_list' %}?category=perawatan" class="px-4 py-2 rounded-xl text-sm font-light transition-all duration-300 {% if current_category == 'perawatan' %}bg-white border-2{% else %}bg-white/50 border{% endif %}" 
                   style="{% if current_category == 'perawatan' %}border-color: rgba(134, 239, 172, 0.4); color: #86efac;{% else %}border-color: rgba(229, 231, 235, 0.6); color: #6b7280;{% endif %}">
                    Perawatan
                </a>
                <a href="{% url 'main:forum_list' %}?category=pengalaman" class="px-4 py-2 rounded-xl text-sm font-light transition-all duration-300 {% if current_category == 'pengalaman' %}bg-white border-2{% else %}bg-white/50 border{% endif %}" 
                   style="{% if current_category == 'pengalaman' %}border-color: rgba(134, 239, 172, 0.4); color: #86efac;{% else %}border-color: rgba(229, 231, 235, 0.6); color: #6b7280;{% endif %}">
                    Pengalaman
                </a>
                <a href="{% url 'main:forum_list' %}?category=teknis" class="px-4 py-2 rounded-xl text-sm font-light transition-all duration-300 {% if current_category == 'teknis' %}bg-white border-2{% else %}bg-white/50 border{% endif %}" 
                   style="{% if current_category == 'teknis' %}border-color: rgba(239, 68, 68, 0.4); color: #ef4444;{% else %}border-color: rgba(229, 231, 235, 0.6); color: #6b7280;{% endif %}">
                    Teknis
                </a>
            </div>
        </div>

        <!-- Messages -->
        {% if messages %}
        <div class="mb-6 space-y-2">
            {% for message in messages %}
            <div class="px-4 py-3 rounded-xl bg-white/80 backdrop-blur-sm border" 
                 style="border-color: {% if message.tags == 'success' %}rgba(134, 239, 172, 0.4){% elif message.tags == 'error' %}rgba(239, 68, 68, 0.4){% else %}rgba(229, 231, 235, 0.6){% endif %};">
                <p class="text-sm font-light" style="color: {% if message.tags == 'success' %}#86efac{% elif message.tags == 'error' %}#ef4444{% else %}#6b7280{% endif %};">
                    {{ message }}
                </p>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Posts List -->
        <div class="space-y-4">
            {% if posts %}
                {% for post in posts %}
                <a href="{% url 'main:forum_detail' post.id %}" class="block group bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/60 p-6 sm:p-8 hover:shadow-xl hover:-translate-y-1 transition-all duration-500" 
                   style="border-color: rgba(229, 231, 235, 0.6);" 
                   onmouseover="this.style.borderColor='{% if post.category == 'penyakit' or post.category == 'teknis' %}rgba(239, 68, 68, 0.4){% else %}rgba(134, 239, 172, 0.4){% endif %}';" 
                   onmouseout="this.style.borderColor='rgba(229, 231, 235, 0.6)';">
                    <div class="flex items-start justify-between gap-4 mb-4">
                        <h3 class="text-gray-900 font-light text-lg sm:text-xl tracking-tight flex-1 transition-colors" 
                            style="{% if post.category == 'penyakit' or post.category == 'teknis' %}color: inherit;{% else %}color: inherit;{% endif %}"
                            onmouseover="this.style.color='{% if post.category == 'penyakit' or post.category == 'teknis' %}#ef4444{% else %}#86efac{% endif %}';"
                            onmouseout="this.style.color='inherit';">
                            {{ post.title }}
                        </h3>
                        <span class="px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap flex-shrink-0" 
                              style="{% if post.category == 'penyakit' or post.category == 'teknis' %}background: rgba(239, 68, 68, 0.1); color: #ef4444; border: 1px solid rgba(239, 68, 68, 0.3);{% else %}background: rgba(134, 239, 172, 0.1); color: #86efac; border: 1px solid rgba(134, 239, 172, 0.3);{% endif %}">
                            {{ post.get_category_display }}
                        </span>
                    </div>
                    <p class="text-gray-600 text-sm sm:text-base font-light leading-relaxed mb-4 line-clamp-2">
                        {{ post.get_excerpt }}
                    </p>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3 sm:gap-4 text-xs sm:text-sm text-gray-600 font-light">
                            <div class="flex items-center gap-2">
                                <div class="w-6 h-6 rounded-full flex items-center justify-center" style="{% if post.category == 'penyakit' or post.category == 'teknis' %}background: rgba(239, 68, 68, 0.2);{% else %}background: rgba(134, 239, 172, 0.2);{% endif %}">
                                    <span class="text-xs font-medium" style="color: {% if post.category == 'penyakit' or post.category == 'teknis' %}#ef4444{% else %}#86efac{% endif %};">{{ post.author.name|first|upper }}</span>
                                </div>
                                <span>{{ post.author.name }}</span>
                            </div>
                            <span>•</span>
                            <span>{{ post.created_at|date:"d M Y" }}</span>
                            <span>•</span>
                            <span>{{ post.views }} dilihat</span>
                        </div>
                        <div class="flex items-center gap-2 text-xs sm:text-sm" style="color: {% if post.category == 'penyakit' or post.category == 'teknis' %}#ef4444{% else %}#86efac{% endif %};">
                            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                            </svg>
                            <span class="font-light">{{ post.get_comment_count }} komentar</span>
                        </div>
                    </div>
                </a>
                {% endfor %}
            {% else %}
                <div class="text-center py-12 bg-white/80 backdrop-blur-sm rounded-2xl border border-gray-200/60" style="border-color: rgba(229, 231, 235, 0.6);">
                    <svg class="w-16 h-16 mx-auto mb-4" style="color: #9ca3af;" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                    </svg>
                    <p class="text-gray-600 font-light text-lg mb-2">Belum ada postingan</p>
                    <p class="text-gray-500 font-light text-sm">Jadilah yang pertama membuat postingan!</p>
                    {% if forum_user %}
                    <a href="{% url 'main:forum_create' %}" class="inline-block mt-4 px-6 py-3 rounded-xl text-white font-light text-sm sm:text-base transition-all duration-300 hover:scale-105" style="background: linear-gradient(135deg, #86efac 0%, #4ade80 100%); box-shadow: 0 4px 12px rgba(134, 239, 172, 0.3);">
                        Buat Postingan Pertama
                    </a>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

